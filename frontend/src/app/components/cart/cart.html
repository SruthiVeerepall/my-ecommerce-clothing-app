<div class="cart-container">
  <div *ngIf="successMessage && successMessage.includes('‚úÖ')" class="toast success">
    {{ successMessage }}
  </div>
  <div *ngIf="successMessage && successMessage.includes('‚ùå')" class="toast error">
    {{ successMessage }}
  </div>
  <div class="cart-header">
    <h1>üõçÔ∏è Your Shopping Cart</h1>
    <button class="btn-back" (click)="goBack()">‚Üê Back to Shopping</button>
  </div>

  <div style="background: #eee; padding: 5px; font-size: 10px; text-align: center;">
    Debug: Items={{cartItems.length}}, Loading={{loading}}
  </div>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading your treasures...</p>
  </div>

  <div *ngIf="!loading && cartItems.length === 0" class="empty-cart">
    <div class="empty-icon">üõí</div>
    <h2>Your cart is empty</h2>
    <p>Looks like you haven't added anything to your cart yet.</p>
    <button class="btn primary" (click)="goBack()">Start Shopping</button>
  </div>

  <div class="cart-content" *ngIf="!loading && cartItems.length > 0">
    <div class="cart-items">
      <div class="cart-item" *ngFor="let item of cartItems">
        <div class="item-image">
          <img [src]="item.product.imageUrl" [alt]="item.product.name" *ngIf="item.product && item.product.imageUrl">
          <div class="placeholder-img" *ngIf="!item.product || !item.product.imageUrl">{{ item.product?.name?.charAt(0) || '?' }}</div>
        </div>
        <div class="item-details">
          <h3>{{ item.product?.name || 'Unknown Product' }}</h3>
          <p class="category">{{ item.product?.category || 'No Category' }}</p>
          <div class="product-options" *ngIf="item.selectedSize || item.selectedColor">
            <span class="option-label" *ngIf="item.selectedSize && item.selectedSize !== 'Default'">
              <strong>Size:</strong> {{ item.selectedSize }}
            </span>
            <span class="option-label" *ngIf="item.selectedColor && item.selectedColor !== 'Default'">
              <strong>Color:</strong> {{ item.selectedColor }}
            </span>
          </div>
          <div class="quantity-controls">
            <span class="qty-label">Quantity:</span>
            <div class="qty-adjuster">
              <button class="qty-btn" (click)="updateQuantity(item, -1)" [disabled]="item.quantity <= 1">‚àí</button>
              <span class="qty-value">{{ item.quantity }}</span>
              <button class="qty-btn" (click)="updateQuantity(item, 1)">+</button>
            </div>
          </div>
        </div>
        <div class="item-price-section">
          <p class="unit-price" *ngIf="item.product">‚Çπ{{ item.product.price }} Each</p>
          <p class="unit-price" *ngIf="!item.product">Price N/A</p>
          <p class="subtotal-price" *ngIf="item.product">‚Çπ{{ (item.product.price || 0) * (item.quantity || 1) }}</p>
          <p class="subtotal-price" *ngIf="!item.product">‚Çπ0.00</p>
          <button class="btn-remove" (click)="removeItem(item.id)" title="Remove item">
            üóëÔ∏è Remove
          </button>
        </div>
      </div>
    </div>

    <div class="cart-summary">
      <h2>Order Summary</h2>
      <div class="summary-details">
        <div class="summary-line">
          <span>Subtotal</span>
          <span>‚Çπ{{ totalAmount }}</span>
        </div>
        <div class="summary-line">
          <span>Shipping</span>
          <span class="free">FREE</span>
        </div>
        <div class="summary-line total">
          <span>Total Amount</span>
          <span>‚Çπ{{ totalAmount }}</span>
        </div>
      </div>
      <button class="btn-checkout" (click)="checkout()">
        Proceed to Checkout
      </button>
    </div>
  </div>
</div>
